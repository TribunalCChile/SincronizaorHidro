import{_ as m,j as c,c as v,w as o,a as n,b as C,e as s,f as D,h as F}from"./index-8UleF4ZQ.js";import{D as f,C as k,a as y}from"./DeviceFilter-CHCZFINI.js";const R={name:"TaskQueue",components:{DatePicker:f,ClientFilter:k,DeviceFilter:y},data(){return{clientSelected:"",clients:[],devices:[],clientsFilter:[],devicesFilter:[],dateRange:[null,null],formatDates:[null,null]}},mounted(){const e=new Date;this.dateRange=[e,e]},methods:{getQueueTasksTest(){let e,t;e=this.dateRange[0],t=this.dateRange[1],this.clients=this.clientsFilter.map(l=>l.id),console.log(this.clients),console.log("Clients: ",this.clientsFilter),console.log("Dispositivos: ",this.devicesFilter),console.log(`Date Range: ${this.dateRange}`),console.log(e),console.log(t)},handleDate(e){this.dateRange=e.map(t=>t instanceof Date?`${t.getFullYear()}-${t.getMonth()+1}-${t.getDate()}`:t),console.log("RANGE DATA: ",this.dateRange)},async getQueueTasks(){try{let e={client:!0,client_id:2};const t=await c.get(this.$store.state.backendUrl+"/clients",{params:e,headers:{"Content-Type":"application/json",Authorization:"Bearer "+this.$store.state.token}});this.clients=t.data,console.log(this.clients[0])}catch(e){console.error("Error en la solicitud a la API:",e),this.ShowError=!0}},handleClients(e){this.clientsFilter=e,this.getDevicesByClients()},handleDevices(e){this.devicesFilter=e,console.log("Devices: ",this.devicesFilter),this.getDevicesByClients()},async getDevices(){try{const e=await c.get(this.$store.state.backendUrl+"/devices",{client:!0,client_id:2,headers:{"Content-Type":"application/json",Authorization:"Bearer "+this.$store.state.token}});this.devices=e.data,console.log(this.devices)}catch(e){console.error("Error en la solicitud a la API:",e),this.ShowError=!0}},async getDevicesByClients(){try{let e=[];for(const t of this.clientsFilter){const l=await c.get(this.$store.state.backendUrl+"/devices",{params:{client_id:t,clientConfig:!0},headers:{"Content-Type":"application/json",Authorization:"Bearer "+this.$store.state.token}});e=e.concat(l.data)}this.devicesFilter=e}catch(e){console.error("Error en la solicitud a la API:",e),this.ShowError=!0}}}},B=F("label",{class:"form-label"},"Fecha",-1);function T(e,t,l,w,r,a){const d=n("DatePicker"),i=n("CCol"),h=n("ClientFilter"),u=n("DeviceFilter"),g=n("CButton"),p=n("CRow");return C(),v(p,null,{default:o(()=>[s(i,null,{default:o(()=>[B,s(d,{modelValue:r.dateRange,"onUpdate:modelValue":[t[0]||(t[0]=_=>r.dateRange=_),a.handleDate],placeholder:"Escoja un rango de fechas",range:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),s(i,{class:"col-3"},{default:o(()=>[s(h,{onFilter:a.handleClients},null,8,["onFilter"])]),_:1}),s(i,{class:"col-3"},{default:o(()=>[s(u,{devices:r.devicesFilter,onFilter:a.handleDevices},null,8,["devices","onFilter"])]),_:1}),s(i,{class:"mt-4"},{default:o(()=>[s(g,{color:"primary",onClick:a.getQueueTasksTest,class:"mt-1"},{default:o(()=>[D(" Buscar ")]),_:1},8,["onClick"])]),_:1})]),_:1})}const V=m(R,[["render",T]]);export{V as default};
